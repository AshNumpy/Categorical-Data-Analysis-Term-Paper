---
title: "Kategorik Veri Ã‡Ã¶zÃ¼mlemesi"
output: html_document
date: "2023-05-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

# Ã‡Ã¶zÃ¼mleme-D
Bir OxN ve NxO tablosu iÃ§in SatÄ±r Etki ve SÃ¼tun Etki modellerinin Ã§Ã¶zÃ¼mlemelerini yapÄ±nÄ±z.

```{r}
df <- read.csv("../Datasets/processed.csv")
head(df,3)
```

## NxO SatÄ±r Etki Modeli Ã‡Ã¶zÃ¼mlemesi

SatÄ±r: Sex (Erkek, KadÄ±n) \
SÃ¼tun: Likert 4 (KÄ±z/Erkek arkadaÅŸÄ±m ben olmadan gece eÄŸlenmeye Ã§Ä±kabilir.) \

|Ã–lÃ§ek|AnlamÄ±|
|:----|:-----|
|1|Kesinlikle katÄ±lmÄ±yorum|
|2|KatÄ±lmÄ±yorum|
|3|Ne katÄ±lÄ±yorum ne de katÄ±lmÄ±yorum|
|4|KatÄ±lÄ±yorum|
|5|Kesinlikle katÄ±lÄ±yorum|


```{r}
tablo <- xtabs(~ Sex + likert_4, data = df)

df_tablo <- as.data.frame.table(tablo)

yeni_tablo <- data.frame(Sex = df_tablo$Sex,
                         Ã–lÃ§ek = df_tablo$likert_4,
                         FrekansÄ± = df_tablo$Freq)

yeni_tablo$Sex <- as.factor(yeni_tablo$Sex)

yeni_tablo$Ã–lÃ§ek <- factor(yeni_tablo$Ã–lÃ§ek,
                                      labels=c("Kesinlikle KatÄ±lmÄ±yorum",
                                               "KatÄ±lmÄ±yorum",
                                               "Ne KatÄ±lÄ±yorum Ne KatÄ±lmÄ±yorum",
                                               "KatÄ±lÄ±yorum",
                                               "Kesinlikle KatÄ±lÄ±yorum"))

likertSkor <- as.numeric(yeni_tablo$Ã–lÃ§ek)
yeni_tablo
```
```{r}
options(contrasts=c("contr.sum","contr.poly"))
```
**Not:** \

- Kontrast kodlamasÄ±, bir faktÃ¶r deÄŸiÅŸkenin kategorik seviyeleri arasÄ±ndaki farklarÄ± ifade etmek iÃ§in kullanÄ±lan bir yÃ¶ntemdir. contr.sum kontrastÄ±, kategoriler arasÄ±ndaki farklarÄ± toplam olarak ifade ederken, contr.poly kontrastÄ± ise polinomik bir eÄŸilimi yansÄ±tÄ±r.

- Ã–rneÄŸin, bir faktÃ¶r deÄŸiÅŸkenin 3 kategorisi varsa, contr.sum kodlamasÄ±yla bir kategori referans alÄ±nÄ±r ve diÄŸer kategoriler bu referans kategoriye gÃ¶re farklar olarak temsil edilir. contr.poly kodlamasÄ± ise kategoriler arasÄ±nda bir polinomik eÄŸilimi ifade etmek iÃ§in kullanÄ±lÄ±r.

```{r}
model <- glm(FrekansÄ± ~ Ã–lÃ§ek + Sex*likertSkor,
             data = yeni_tablo, 
             family = poisson)

#install.packages("vcdExtra")
library(vcdExtra)
LRstats(model)
```

$H_0:$ SatÄ±r etki modeline uyum vardÄ±r.  
$H_1:$ SatÄ±r etki modeline uyum yoktur

p-deÄŸeri=0.4106, $\alpha=0.05$'ten bÃ¼yÃ¼k olduÄŸu iÃ§in yokluk hipotezi reddedilemez. %95 GÃ¼venle sÃ¶ylenebilir ki satÄ±r etki modeline uyum vardÄ±r.

**Not:**\
SatÄ±r modeline uyum olduÄŸu iÃ§in, beklenen sÄ±klÄ±klar Ã¼zerinden satÄ±r dÃ¼zeyindeki yerel odds oranlarÄ± birbirine eÅŸittir

---

```{r}
summary(model)
```

SatÄ±r etki modeline gÃ¶re $\hat{\mu_1}$ katsayÄ±sÄ± -0.21083 olarak tahmin edilmiÅŸtir. Buradan hareketle $\hat{\mu_2}=0-(-0.21083)=0.21083$ olarak bulunmuÅŸ oldu. SatÄ±r etkileri iÃ§in;

$H_0: \mu_i = 0$
$H_1: \mu_i \neq 0$

p-value=0.013781 < $\alpha=0.05$'ten kÃ¼Ã§Ã¼k olduÄŸu iÃ§in yokluk hipotezi reddedilir. SatÄ±r etkisi %5 hata payÄ±yla istatistiksel olarak anlamlÄ±dÄ±r.

### Beklenen SÄ±klÄ±klarÄ±n HesaplanmasÄ±:
```{r}
matrix(fitted(model), byrow = T, ncol = 5,
       dimnames = list(
         Sex=c("Erkek", "KadÄ±n"),
         Ã–lÃ§ek=c("K. KatÄ±lmÄ±yorum",
                 "KatÄ±lmÄ±yorum",
                 "NÃ¶trÃ¼m",
                 "KatÄ±lÄ±yorum",
                 "K. KatÄ±lÄ±yorum")
       ))
```

### Odds OranlarÄ±nÄ±n HesaplanmasÄ±
```{r}
mu1 <- coef(model)["Sex1:likertSkor"];mu1
mu2 <- 0 - (mu1);mu2

teta11 <- exp(mu2-mu1);teta11
```
$$\theta_{11} = e^{\hat{\mu_2} - \hat{\mu_1}} \approx 1.52$$
**Yorum:** \
- "KÄ±z/Erkek arkadaÅŸÄ±m ben olmadan gece eÄŸlenmeye Ã§Ä±kabilir" Ã¶nergesine katÄ±lma durumunun j. dÃ¼zeyde olanlarÄ±n (ğ‘—+1). dÃ¼zeyde olmasÄ±na gÃ¶re, cinsiyetin kadÄ±n olmasÄ±nÄ±n erkek olmasÄ±na gÃ¶re bu Ã¶nergeye katÄ±lma olasÄ±lÄ±ÄŸÄ±nÄ± 1,52 kat arttÄ±rmaktadÄ±r.


## OxN SÃ¼tun Etki Modeli Ã‡Ã¶zÃ¼mlemesi
SatÄ±ra ordinal bir deÄŸiÅŸken olarak, gÃ¶rÃ¼ÅŸÃ¼len gÃ¼n sayÄ±sÄ±nÄ± 3 guruba balyaladÄ±m.

SÃ¼tun: Soru13: KÄ±z / Erkek arkadaÅŸÄ±nÄ±zla bir ayda yaklaÅŸÄ±k kaÃ§ gÃ¼n gÃ¶rÃ¼ÅŸÃ¼yorsunuz?
SatÄ±r: Department

```{r}
df$GÃ¶rÃ¼ÅŸÃ¼lenGÃ¼n <- cut(df$soru13,
                     breaks = c(0, 10, 20, 30),
                     labels = c("DÃ¼ÅŸÃ¼k", "Orta", "YÃ¼ksek"),
                     right = FALSE)
head(df)
```

```{r}
tablo <- xtabs(~ GÃ¶rÃ¼ÅŸÃ¼lenGÃ¼n + soru8, data = df)

df_tablo <- as.data.frame.table(tablo)

df_tablo$GÃ¶rÃ¼ÅŸÃ¼lenGÃ¼n <- as.factor(df_tablo$GÃ¶rÃ¼ÅŸÃ¼lenGÃ¼n)
df_tablo$soru8 <- as.factor(df_tablo$soru8)

library(dplyr)
df_tablo$soru8 <- recode(df_tablo$soru8,
                         "KiÅŸinin fiziksel Ã¶zellikleri (boy, kilo, saÃ§ rengi vb.)"="Fizik",
                         "KiÅŸinin karakteri ve kiÅŸilik Ã¶zellikleri"="Karakter",
                         "KiÅŸinin maddi ve ekonomik durumu"="Maddiyat")

GSkor <- as.numeric(df_tablo$GÃ¶rÃ¼ÅŸÃ¼lenGÃ¼n)
df_tablo
```
```{r}
model <- glm(Freq ~ GÃ¶rÃ¼ÅŸÃ¼lenGÃ¼n + soru8*GSkor,
             data = df_tablo,
             family = poisson)

library(vcdExtra)
LRstats(model)
```

$H_0:$ Kurulan sÃ¼tun etki modele uyum vardÄ±r.  
$H_1:$ Kurulan sÃ¼tun etki modele uyum yoktur.  

p-value=0.1944 deÄŸeri $\alpha=0.05$'ten bÃ¼yÃ¼k olduÄŸu iÃ§in yokluk hipotezi reddedilemez. SÃ¼tun etki modeline uyum vardÄ±r ÅŸeklinde bir yorum %5 hata ile yapÄ±labilir.

```{r}
summary(model)
```

SatÄ±r etki modeline gÃ¶re $\hat{\tau_1}$ katsayÄ±sÄ± 0.2898, $\hat{\tau_2}$ katsayÄ±sÄ± 0.4864 olarak tahmin edilmiÅŸtir. Buradan hareketle $\hat{\tau_3}=0-(0.2898+0.4864) = -0.7762$ olarak bulunmuÅŸ oldu. sÃ¼tun etkileri iÃ§in;

$H_0: \tau_i = 0$
$H_1: \tau_i \neq 0$

p-value > $\alpha=0.05$'ten kÃ¼Ã§Ã¼k olduÄŸu iÃ§in yokluk hipotezi reddedilemez. SÃ¼tun etkileri istatistiksel olarak anlamlÄ± bulunmamÄ±ÅŸtÄ±r.

### Odds OranlarÄ±

```{r}
maddiyatSkor<- 0-(coef(model)["soru81:GSkor"]+coef(model)["soru82:GSkor"])

theta11 <- exp(coef(model)["soru82:GSkor"]-coef(model)["soru81:GSkor"]);theta11

theta12 <- exp(maddiyatSkor-coef(model)["soru82:GSkor"]);theta12

theta13 <- exp(maddiyatSkor-coef(model)["soru81:GSkor"]);theta13
```

$$\theta_{11} = e^{\hat{\tau_2} - \hat{\tau_1}} \approx 1.22$$
$$\theta_{12} = e^{\hat{\tau_3} - \hat{\tau_2}} \approx 0.28$$
$$\theta_{13} = e^{\hat{\tau_3} - \hat{\tau_1}} \approx 0.34$$

**Yorumlar:**  

- "KÄ±z/Erkek arkadaÅŸÄ± seÃ§iminde hangi faktÃ¶r sizin iÃ§in en Ã¶nemlisidir?" sorusuna verilen yanÄ±tlar bakÄ±mÄ±ndan "Fizik" yanÄ±tÄ±nÄ± verenlerin "Karakter" yanÄ±tÄ±nÄ± verenlere gÃ¶re KÄ±z/Erkek arkadaÅŸÄ±yla ayda gÃ¶rÃ¼ÅŸtÃ¼ÄŸÃ¼ gÃ¼n sayÄ±sÄ±nÄ±n (i+1). dÃ¼zeyde olmasÄ±na gÃ¶re i. dÃ¼zeyde olmasÄ± olasÄ±lÄ±ÄŸÄ± 1.22 kat fazladÄ±r.

- KÄ±z/Erkek arkadaÅŸÄ±yla ayda gÃ¶rÃ¼ÅŸtÃ¼ÄŸÃ¼ gÃ¼n sayÄ±sÄ±nÄ±n (i+1). dÃ¼zeyde olmasÄ±na gÃ¶re i. dÃ¼zeyde olanlarÄ±n,"KÄ±z/Erkek arkadaÅŸÄ± seÃ§iminde hangi faktÃ¶r sizin iÃ§in en Ã¶nemlisidir?" sorusuna verdikleri yanÄ±tlar bakÄ±mÄ±ndan "Maddiyat" yanÄ±tÄ±nÄ± vermesi "Karakter" yanÄ±tÄ±nÄ± vermesine gÃ¶re ($1/0.28=3.57$) kat fazladÄ±r.

- KÄ±z/Erkek arkadaÅŸÄ±yla ayda gÃ¶rÃ¼ÅŸtÃ¼ÄŸÃ¼ gÃ¼n sayÄ±sÄ±nÄ±n (i+1). dÃ¼zeyde olmasÄ±na gÃ¶re i. dÃ¼zeyde olanlarÄ±n,"KÄ±z/Erkek arkadaÅŸÄ± seÃ§iminde hangi faktÃ¶r sizin iÃ§in en Ã¶nemlisidir?" sorusuna verdikleri yanÄ±tlar bakÄ±mÄ±ndan "Maddiyat" yanÄ±tÄ±nÄ± verenlerin "Fizik" yanÄ±tÄ±nÄ± verenlere gÃ¶re ($1/0.34=2.94$) kat fazladÄ±r.